---
name: 地址范围管理功能
status: open
created: 2025-09-09T04:10:01Z
updated: 2025-09-09T04:10:01Z
github: [Will be updated when synced to GitHub]
depends_on: [001]
parallel: true
conflicts_with: [003]
---

# Task: 地址范围管理功能

## Description

实现Modbus地址范围的配置和管理功能，支持多个连续地址段配置，每段长度不超过120，包括地址验证、冲突检测和用户友好的管理界面。

## Acceptance Criteria

- [ ] 创建AddressRangeManager组件，支持添加/删除/编辑地址段
- [ ] 实现地址段验证：连续性检查、长度限制（≤120）、重叠检测
- [ ] 支持多地址段管理，提供清晰的列表展示
- [ ] 添加地址段预设模板（如：常用传感器地址段）
- [ ] 实现地址段导入/导出功能（JSON格式）
- [ ] 创建地址段配置的可视化预览
- [ ] 添加批量地址段操作（清空、复制、排序）

## Technical Details

### 实现方案

1. **数据结构**:
   ```tsx
   // src/types/modbus.ts
   interface AddressRange {
     id: string;
     name?: string;
     startAddress: number;
     length: number;
     dataType: 'uint16' | 'int16' | 'uint32' | 'int32' | 'float32';
     description?: string;
   }
   
   interface AddressRangeConfig {
     ranges: AddressRange[];
     maxRangeLength: number; // 120
   }
   ```

2. **组件结构**:
   ```tsx
   // src/components/AddressRangeManager.tsx
   export function AddressRangeManager() {
     // 地址段列表管理
     // 添加/编辑/删除操作
     // 验证和冲突检测
   }
   
   // src/components/AddressRangeEditor.tsx
   export function AddressRangeEditor() {
     // 单个地址段编辑器
   }
   ```

3. **验证逻辑**:
   ```tsx
   // src/utils/addressValidation.ts
   export const validateAddressRange = (range: AddressRange): ValidationResult => { ... };
   export const detectRangeOverlaps = (ranges: AddressRange[]): OverlapResult[] => { ... };
   export const isValidRangeLength = (length: number): boolean => length <= 120;
   ```

4. **界面设计**:
   ```
   ┌─────────────────────────────────────────────┐
   │ 地址范围配置                                 │
   ├─────────────────────────────────────────────┤
   │ [+ 添加地址段] [模板▼] [导入] [导出]         │
   │                                             │
   │ ┌─ 地址段1 ─────────────────────── [编辑][x]│
   │ │ 起始地址: 1000  长度: 50                  │
   │ │ 类型: uint16   描述: 温度传感器            │
   │ │ 地址范围: 1000-1049                       │
   │ └─────────────────────────────────────────│
   │                                             │
   │ ┌─ 地址段2 ─────────────────────── [编辑][x]│
   │ │ 起始地址: 2000  长度: 30                  │
   │ │ 类型: int16    描述: 压力传感器            │
   │ │ 地址范围: 2000-2029                       │
   │ └─────────────────────────────────────────│
   │                                             │
   │ 总地址数: 80/120 (可用)                     │
   └─────────────────────────────────────────────┘
   ```

### 核心功能
- **地址段CRUD**: 创建、读取、更新、删除地址段
- **验证引擎**: 实时验证地址有效性和冲突检测
- **模板系统**: 预定义常用设备的地址段配置
- **配置管理**: 保存/加载地址段配置

## Dependencies

- [ ] 任务001（项目初始化）- shadcn/ui组件可用
- [ ] 地址段配置数据结构设计
- [ ] 用户体验设计评审

## Effort Estimate

- Size: L
- Hours: 16-20小时
- Parallel: true（与连接配置独立开发）

## Definition of Done

- [ ] 用户可以添加、编辑、删除地址段
- [ ] 地址段重叠和长度超限能够被正确检测和提示
- [ ] 地址段配置可以保存和恢复
- [ ] 预设模板功能正常，提高配置效率
- [ ] 导入/导出功能正常，支持配置备份
- [ ] 界面直观易用，配置过程流畅
- [ ] 地址段总数和使用情况清晰显示