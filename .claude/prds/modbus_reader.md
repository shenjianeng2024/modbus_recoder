---
name: modbus_reader
description: 实验室环境下的Modbus TCP/IP数据读取、记录和导出系统
status: backlog
created: 2025-09-09T03:48:43Z
---

# PRD: modbus_reader

## Executive Summary

modbus_reader是一个专为实验室环境设计的Modbus TCP/IP数据采集和记录系统。该系统使用现代桌面技术栈（Tauri + React + shadcn + Rust），为工厂技术员提供直观的界面来配置数据采集参数，执行单次读取和批量记录，并将数据导出为CSV格式进行后续分析。

## Problem Statement

### 当前痛点
- 实验室中缺乏便捷的Modbus设备数据采集工具
- 现有工具要么过于复杂，要么功能单一
- 需要既能进行单次读取验证，又能进行长时间数据记录的工具
- 数据导出格式需要便于后续分析和处理

### 解决必要性
- 提高实验室数据采集效率
- 简化Modbus设备调试和数据分析流程
- 为技术员提供专业且易用的工具

## User Stories

### 主要用户：工厂技术员

#### 用户角色描述
- 需要调试和测试Modbus设备
- 熟悉工业协议但希望工具简单易用
- 需要可靠的数据采集和导出功能

#### 核心用户旅程

**场景1：设备连接验证**
- 作为技术员，我需要配置设备IP和端口
- 我需要设置要读取的地址范围
- 我需要执行单次读取来验证连接和数据正确性
- 我需要在界面上直接查看读取结果

**验收标准：**
- 能够配置IP地址（支持IPv4格式验证）
- 能够配置端口号（1-65535范围）
- 能够设置多个连续的地址段（每段≤120个地址）
- 单次读取结果实时显示在界面上
- 读取失败时显示明确的错误信息

**场景2：数据批量采集**
- 作为技术员，我需要开始长时间的数据记录
- 我需要设置采集频率（毫秒级精度）
- 我需要能够随时停止采集
- 我需要将采集的数据导出为CSV文件

**验收标准：**
- 采集频率可设置（最小单位：毫秒）
- 开始/停止采集功能正常
- 数据自动保存在后台
- 导出的CSV文件包含时间戳和所有采集数据
- 导出过程不影响正在进行的采集

**场景3：远程访问和操作**
- 作为技术员，我需要在不同位置访问采集系统
- 我需要远程监控采集状态
- 我需要远程导出数据

**验收标准：**
- 支持网络访问（具体实现方式待定）
- 远程界面功能与本地一致
- 远程操作响应时间<1秒

## Requirements

### Functional Requirements

#### FR1: 连接配置
- 支持Modbus TCP/IP协议
- IP地址配置（IPv4格式验证）
- 端口配置（默认502，可修改）
- 连接测试功能

#### FR2: 地址范围管理
- 支持配置多个地址段
- 每个地址段连续且长度≤120
- 地址范围验证（避免重叠）
- 地址段的增删改功能

#### FR3: 数据采集模式
**单次读取模式：**
- 立即读取所有配置的地址段
- 结果实时显示在界面上
- 不保存到本地存储

**批量采集模式：**
- 可配置采集频率（毫秒级）
- 开始/停止控制
- 后台连续采集和存储
- 采集状态实时显示

#### FR4: 数据存储和导出
- 采集数据临时存储
- CSV格式导出
- 包含时间戳的数据记录
- 导出文件命名规则

#### FR5: 错误处理和报警
- 连接失败检测
- 读取超时处理
- 设备响应错误处理
- 用户友好的错误提示

#### FR6: 用户界面
- 基于shadcn/ui的现代界面设计
- 直观的配置面板
- 清晰的状态指示
- 响应式布局

### Non-Functional Requirements

#### NFR1: 性能要求
- 响应时间：毫秒级（<100ms用于界面响应）
- 采集精度：毫秒级时间戳
- 内存使用：持续运行时<100MB
- CPU使用：正常采集时<10%

#### NFR2: 可靠性要求
- 24小时连续运行稳定性
- 网络中断自动重连
- 数据完整性保证
- 异常情况下的优雅降级

#### NFR3: 可用性要求
- 界面响应时间<1秒
- 学习成本低（<30分钟上手）
- 错误信息清晰易懂
- 支持常见操作系统（Windows, macOS, Linux）

#### NFR4: 安全性要求
- 本地数据安全存储
- 网络通信安全（如果支持远程访问）
- 输入验证和防护

## Success Criteria

### 主要KPI
- **功能完整性**：100%完成核心功能需求
- **稳定性指标**：连续运行24小时无崩溃
- **性能指标**：读取响应时间<100ms
- **用户满意度**：技术员能够在30分钟内完成首次使用

### 验收标准
- [ ] 成功连接Modbus TCP/IP设备
- [ ] 准确读取配置的地址范围数据
- [ ] 单次读取和批量采集模式正常工作
- [ ] CSV导出功能完整可用
- [ ] 错误处理机制有效
- [ ] 跨平台兼容性验证

## Constraints & Assumptions

### 技术约束
- 使用Tauri + React + shadcn + Rust技术栈
- 后端使用tokio-modbus库
- 包管理使用pnpm
- 仅支持Modbus TCP/IP协议

### 资源约束
- 单一设备连接（不支持多设备同时连接）
- 地址段长度限制（≤120）
- 实验室环境部署（非生产环境）

### 假设条件
- 用户具备基本的Modbus协议知识
- 网络环境稳定
- 目标设备支持标准Modbus TCP/IP协议

## Out of Scope

### 明确不包含的功能
- 多设备同时连接
- Modbus RTU/ASCII协议支持
- 实时数据可视化（图表、趋势图）
- 数据库存储功能
- 高级数据分析功能
- 用户权限管理
- 复杂的网络配置（VPN、代理等）
- 移动端应用

### 未来版本考虑
- 多设备支持
- 数据可视化
- 云端数据同步
- 高级分析功能

## Dependencies

### 外部技术依赖
- **tokio-modbus**: Rust的Modbus客户端库
- **Tauri**: 跨平台桌面应用框架
- **React 19**: 前端UI框架
- **shadcn/ui**: UI组件库
- **pnpm**: 包管理器

### 系统依赖
- 操作系统：Windows 10+, macOS 10.15+, Linux (Ubuntu 18.04+)
- Node.js: 16+
- Rust: 1.70+
- 网络：TCP/IP网络连接

### 内部依赖
- 无特定内部系统依赖
- 需要网络访问权限（Modbus TCP连接）

## Implementation Notes

### 技术架构建议
- 前端：React + TypeScript + shadcn/ui
- 后端：Rust + Tauri + tokio-modbus
- 状态管理：React hooks或简单的状态管理
- 错误处理：统一的错误处理机制
- 数据持久化：本地文件系统（CSV）

### 开发优先级
1. **P0**: 基本连接和单次读取功能
2. **P0**: 地址范围配置和验证
3. **P1**: 批量采集和停止功能
4. **P1**: CSV导出功能
5. **P2**: 错误处理和用户体验优化
6. **P2**: 远程访问功能

### 风险和缓解措施
- **风险**: tokio-modbus库兼容性问题
  - **缓解**: 早期进行技术验证和原型开发
- **风险**: 跨平台兼容性问题
  - **缓解**: 在多个平台进行测试
- **风险**: 网络稳定性影响数据采集
  - **缓解**: 实现重连机制和数据完整性检查